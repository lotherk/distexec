set(CPACK_PACKAGE_CONTACT "Konrad Lother <k@hiddenbox.org>")
SET(CPACK_PACKAGE_VERSION_MAJOR ${PROJECT_VERSION_MAJOR})
SET(CPACK_PACKAGE_VERSION_MINOR ${PROJECT_VERSION_MINOR})
SET(CPACK_PACKAGE_VERSION_PATCH ${PROJECT_VERSION_PATCH})
set(CPACK_RESOURCE_FILE_LICENSE "${CMAKE_CURRENT_SOURCE_DIR}/COPYING")
set(CPACK_SOURCE_PACKAGE_FILE_NAME
	"${CMAKE_PROJECT_NAME}-${CPACK_PACKAGE_VERSION_MAJOR}.${CPACK_PACKAGE_VERSION_MINOR}.${CPACK_PACKAGE_VERSION_PATCH}")
SET(CPACK_PACKAGE_DESCRIPTION_FILE "${CMAKE_CURRENT_SOURCE_DIR}/Description.txt")
#SET(CPACK_PACKAGING_INSTALL_PREFIX ${CMAKE_INSTALL_PREFIX})

if(WIN32)
	#	set(CPACK_WIX_UPGRADE_GUID "91C11B85-620B-4C5B-BF87-158277FA63C0")
	set(CPACK_GENERATOR "ZIP")
	file(GLOB EXT_LIBRARIES ${CMAKE_CURRENT_SOURCE_DIR}/ext/windows/lib/*.dll)
	install(FILES ${EXT_LIBRARIES} DESTINATION bin)
	install(PROGRAMS windows/distexec.bat DESTINATION .)
elseif(APPLE)
	# haven't found one yet...
	SET(CPACK_PACKAGING_INSTALL_PREFIX /Distexec)
	install(PROGRAMS macosx/distexec.sh DESTINATION .)
	set(CPACK_GENERATOR "ZIP")
else(WIN32)
	set(CPACK_GENERATOR "DEB;ZIP")
endif(WIN32)

set(CPACK_PACKAGE_FILE_NAME
	"${CMAKE_PROJECT_NAME}-${PROJECT_VERSION}-${CMAKE_SYSTEM_NAME}-${CMAKE_HOST_SYSTEM_PROCESSOR}")
set(CPACK_SOURCE_IGNORE_FILES
	"/tmp/;/build/;/.bzr/;/.git*;/**swp;~$;.etmpl.yml;${CPACK_SOURCE_IGNORE_FILES}")
include(CPack)
